<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de IR para Trades</title>
    <style>
        /* CSS para Estilo e Layout */
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f4f4f9;
            color: #333;
        }
        .container {
            max-width: 600px;
            margin: auto;
            background: #fff;
            padding: 20px 30px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        h2 {
            color: #007bff;
            border-bottom: 2px solid #007bff;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        .input-group {
            margin-bottom: 15px;
        }
        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        .input-group input, .input-group select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box; /* Garante que o padding n칚o aumente a largura total */
        }
        button {
            background-color: #28a745;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            width: 100%;
        }
        button:hover {
            background-color: #218838;
        }
        #relatorio {
            margin-top: 25px;
            padding: 15px;
            border: 1px dashed #6c757d;
            border-radius: 4px;
            background-color: #e9ecef;
        }
        .result-item {
            padding: 5px 0;
            border-bottom: 1px dotted #ccc;
        }
        .result-label {
            font-weight: bold;
            display: inline-block;
            width: 60%;
        }
        .result-value {
            float: right;
            font-weight: bold;
        }
        /* Cores para Lucro/Preju칤zo */
        .lucro { color: green; }
        .prejuizo { color: red; }
        .darf { color: #007bff; }
        .header-section {
            font-weight: bold;
            margin-top: 10px;
            padding-top: 5px;
            border-top: 2px solid #adb5bd;
        }
    </style>
</head>
<body>

<div class="container">
    <h2>游눯 Calculadora de IR para Trades</h2>

    <div class="input-group">
        <label for="ativo">Ativo Negociado (Ex: PETR4)</label>
        <input type="text" id="ativo" value="PETR4" required>
    </div>
    
    <div class="input-group">
        <label for="qtd">Quantidade de Pap칠is</label>
        <input type="number" id="qtd" value="100" min="1" required>
    </div>

    <div class="input-group">
        <label for="compra">Pre칞o de Compra por Papel (R$)</label>
        <input type="number" id="compra" value="30.00" step="0.01" required>
    </div>

    <div class="input-group">
        <label for="venda">Pre칞o de Venda por Papel (R$)</label>
        <input type="number" id="venda" value="32.50" step="0.01" required>
    </div>
    
    <div class="input-group">
        <label for="tipoOperacao">Tipo de Opera칞칚o</label>
        <select id="tipoOperacao">
            <option value="SWING TRADE" selected>SWING TRADE (Al칤quota 15%)</option>
            <option value="DAY TRADE">DAY TRADE (Al칤quota 20%)</option>
        </select>
    </div>

    <button onclick="calcularTrade()">Calcular Lucro e IR</button>

    <div id="relatorio">
        <p style="text-align: center;">Preencha os dados e clique em calcular para gerar o relat칩rio.</p>
    </div>
</div>

<script>
    /* JavaScript para a L칩gica de C치lculo */

    function formatarMoeda(valor) {
        return `R$ ${valor.toFixed(2).replace('.', ',').replace(/(\d)(?=(\d{3})+(?!\d))/g, '$1.')}`;
    }

    function calcularTrade() {
        const ativo = document.getElementById('ativo').value.toUpperCase();
        const qtd = parseFloat(document.getElementById('qtd').value);
        const compra = parseFloat(document.getElementById('compra').value);
        const venda = parseFloat(document.getElementById('venda').value);
        const tipoOperacao = document.getElementById('tipoOperacao').value;

        // Valida칞칚o b치sica
        if (isNaN(qtd) || isNaN(compra) || isNaN(venda) || qtd <= 0) {
            alert("Por favor, insira valores v치lidos e positivos para a quantidade e pre칞os.");
            return;
        }

        // --- Vari치veis de C치lculo ---
        const valorTotalCompra = compra * qtd;
        const valorTotalVenda = venda * qtd;
        const lucroBruto = valorTotalVenda - valorTotalCompra;

        // Al칤quotas
        const irrfAliquotaSwing = 0.00005; // 0.005% sobre o valor vendido (Dedo-Duro)
        let aliquotaIR = 0;
        let irDevidoTotal = 0;

        // 1. IRRF Recolhido pela Corretora (Sempre sobre o valor total vendido em Swing Trade, conforme sua regra)
        const irrfRecolhidoCorretora = valorTotalVenda * irrfAliquotaSwing;

        // 2. C치lculo do IR Devido (Apenas se houver lucro)
        if (lucroBruto > 0) {
            aliquotaIR = (tipoOperacao === "DAY TRADE") ? 0.20 : 0.15; // 20% DT, 15% ST
            irDevidoTotal = lucroBruto * aliquotaIR;
        }

        // 3. IR a Pagar via DARF (Diferen칞a)
        const irDevidoDarf = Math.max(0, irDevidoTotal - irrfRecolhidoCorretora);
        
        // --- Gera칞칚o do Relat칩rio HTML ---
        let relatorioHTML = `
            <h3 style="color: #495057; text-align: center;">RELAT칍RIO DE TRADE (${tipoOperacao})</h3>
            <div class="result-item">
                <span class="result-label">ATIVO NEGOCIADO:</span>
                <span class="result-value">${ativo}</span>
            </div>
            <div class="result-item">
                <span class="result-label">VALOR TOTAL DA COMPRA:</span>
                <span class="result-value">${formatarMoeda(valorTotalCompra)}</span>
            </div>
            <div class="result-item">
                <span class="result-label">VALOR TOTAL DA VENDA:</span>
                <span class="result-value">${formatarMoeda(valorTotalVenda)}</span>
            </div>
            <div class="result-item">
                <span class="result-label">LUCRO AUFERIDO / PREJU칈ZO:</span>
                <span class="result-value ${lucroBruto >= 0 ? 'lucro' : 'prejuizo'}">
                    ${formatarMoeda(lucroBruto)}
                </span>
            </div>
            
            <div class="header-section">INFORMA칂칏ES FISCAIS</div>
            <div class="result-item">
                <span class="result-label">AL칈QUOTA DE IR:</span>
                <span class="result-value">${aliquotaIR * 100}%</span>
            </div>
            <div class="result-item">
                <span class="result-label">IR DEVIDO TOTAL (se Lucro):</span>
                <span class="result-value">${formatarMoeda(irDevidoTotal)}</span>
            </div>
            <div class="result-item">
                <span class="result-label">IRRF RECOLHIDO NA FONTE (0,005% Venda):</span>
                <span class="result-value">${formatarMoeda(irrfRecolhidoCorretora)}</span>
            </div>
            
            <div class="header-section">PAGAMENTO VIA DARF</div>
            <div class="result-item">
                <span class="result-label">IR A PAGAR VIA DARF:</span>
                <span class="result-value darf">${formatarMoeda(irDevidoDarf)}</span>
            </div>
            <p style="font-size: 0.8em; text-align: center; margin-top: 15px;">
                ${lucroBruto > 0 
                    ? 'Lembre-se: O valor da DARF 칠 a diferen칞a entre o IR Total Devido e o IRRF retido.' 
                    : 'Preju칤zos podem ser compensados em lucros futuros.'
                }
            </p>
        `;

        document.getElementById('relatorio').innerHTML = relatorioHTML;
    }
</script>
</body>
</html>
